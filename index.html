<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Upload lên GitHub</title>
<style>
body {
  font-family: Arial, sans-serif;
  background: #0d1117;
  color: #fff;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100vh;
}
input, button {
  margin: 10px;
  padding: 10px;
  font-size: 16px;
  border-radius: 8px;
  border: none;
}
button {
  background: #238636;
  color: white;
  cursor: pointer;
}
button:hover { background: #2ea043; }
</style>
</head>
<body>
  <h2>📤 Upload file lên GitHub repo duyxyz/duyxyz</h2>
  <input type="file" id="fileInput" />
  <button onclick="upload()">Tải lên</button>
  <p id="msg"></p>

<script>
const TOKEN = "ghp_XXXXXXX"; // ⚠️ Thay token test của Duy vào đây

async function upload() {
  const file = document.getElementById("fileInput").files[0];
  if (!file) return alert("Chọn file trước nha!");

  const base64 = await fileToBase64(file);
  const repo = "duyxyz/duyxyz";
  const path = `uploads/${file.name}`;
  
  const res = await fetch(`https://api.github.com/repos/${repo}/contents/${path}`, {
    method: "PUT",
    headers: {
      "Authorization": `Bearer ${TOKEN}`,
      "Content-Type": "application/json",
    },
    body: JSON.stringify({
      message: `upload ${file.name}`,
      content: base64
    })
  });
  
  const data = await res.json();
  document.getElementById("msg").innerText =
    res.ok ? "✅ Thành công: " + data.content.path : "❌ Lỗi: " + JSON.stringify(data);
}

function fileToBase64(file) {
  return new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.onload = () => resolve(reader.result.split(",")[1]);
    reader.onerror = reject;
    reader.readAsDataURL(file);
  });
}
</script>
</body>
</html>